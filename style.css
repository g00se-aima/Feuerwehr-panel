/* Grid layout for areas on vehicle pages */
#areas-container {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-auto-rows: minmax(180px, auto);
  gap: 24px;
  width: 100%;
  max-width: 1200px;
  margin: 0 auto 32px auto;
  justify-items: stretch;
  align-items: stretch;
}

.moveable-area {
  min-width: 0;
  min-height: 140px;
  border: 2px dashed #666;
  border-radius: 10px;
  background: #f8fafd;
  margin: 0;
  padding: 12px 14px 18px 14px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  transition: border-color 0.2s, background 0.2s;
}
/* Moveable area drop zone styling */
.moveable-area {
  min-width: 220px;
  min-height: 140px;
  border: 2px dashed #666;
  border-radius: 10px;
  background: #f8fafd;
  margin: 18px 0;
  padding: 12px 14px 18px 14px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  transition: border-color 0.2s, background 0.2s;
}
.moveable-area.area-dragover {
  border-color: #3b82f6;
  background: #e6f0ff;
}
.area-title {
  font-size: 1.1rem;
  font-weight: bold;
  margin-bottom: 10px;
  color: #222;
}
.area-content {
  width: 100%;
  min-height: 40px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}
/* Sidebar close button (black 'x') */
.sidebar-close-btn {
  position: absolute;
  top: 8px;
  right: 14px;
  background: none;
  border: none;
  color: #111;
  font-size: 1.6em;
  font-weight: bold;
  cursor: pointer;
  z-index: 1010;
  padding: 0;
  line-height: 1;
}
.sidebar-close-btn:hover {
  color: #e00;
}

/* Sidebar assignment grid: two rows, all buttons visible, no scroll */
.sidebar-assignment-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  width: 100%;
  margin-top: 10px;
  margin-bottom: 0;
  justify-content: flex-start;
}
.sidebar-assignment-btn {
  flex: 1 1 48%;
  max-width: 48%;
  min-width: 120px;
  box-sizing: border-box;
  margin-bottom: 0 !important;
}
.btn-red {
  background: var(--red);
  color: #fff;
  border: none;
  font-weight: bold;
}
.combined-half {
  background: linear-gradient(90deg, #111 50%, gold 50%);
  color: #fff;
  font-weight: bold;
  border: 2px solid #222;
}
/* 2x4 grid for main menu buttons */
/* 2 columns x 4 rows for main menu buttons */
.button-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: repeat(4, auto);
  gap: 24px;
  margin: 32px 0;
  justify-items: stretch;
  align-items: stretch;
}
:root{
  --bg:#f4f4f7; --greybtn:#d0d0d6; --purple:#7b4ce6; --black:#111; --white:#fff; --red:#cc2222; --gold:#ffd166; --yellow:#fff18f; --erk:#3b82f6;
  /* header height used to push page content below fixed header */
  --header-height: 64px;
}
/* Width used for the PSA dropzone; other rules reference this so it's easy to adjust */
:root { --psa-width: 180px; }
header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;
  background: var(--white);
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
}

/* Removed empty body rule */
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto, "Helvetica Neue", Arial;-webkit-user-select:none;user-select:none;-webkit-touch-callout:none;touch-action:manipulation;}
body{background:var(--bg);color:var(--black);display:flex;flex-direction:column;}
header{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;background:#fff;border-bottom:1px solid #e1e1e5;gap:12px;position:sticky;top:0;z-index:50}
.left-controls{display:flex;align-items:center;gap:8px}
.btn{padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:600;display:inline-block;-webkit-tap-highlight-color:transparent}
.btn-black{background:var(--black);color:var(--white)}
.btn-grey{background:var(--greybtn);color:#000}
.btn-purple{background:var(--purple);color:#fff}
.btn-red-black{background:var(--red);color:#000;border:2px solid #000}
.btn-blue{background:#1976d2;color:#fff;border:none}
.btn-small{padding:6px 10px;font-size:0.9rem;border-radius:6px}
.page-title{margin:8px 0 20px;font-size:1.6rem;text-align:center}
main.container{flex:1;display:flex;align-items:flex-start;justify-content:center;padding:20px;padding-top:calc(var(--header-height) + 12px);box-sizing:border-box}
  .card{background:#fff;border-radius:12px;box-shadow:0 6px 22px rgba(16,24,40,0.06);padding:18px;width:100%;max-width:none;margin:0;}
.center-col{display:flex;flex-direction:column;align-items:center;gap:12px}
.hauptmenu{min-height:60vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:40px 20px;color:#fff}
.main-grid{display:grid;grid-template-columns:repeat(2,1fr);grid-auto-rows:90px;gap:18px;margin-top:18px;max-width:800px;width:100%}
.main-grid .btn{background:var(--greybtn);border-radius:12px;font-size:1.02rem;color:#000}

/* lists & pa buttons */
.page-buttons{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
/* Gold FL button */
.fl-btn.gold {
  background: var(--gold);
  color: #111;
  border: 2px solid #000;
  font-weight: 700;
}
.fl-btn.yellow-grey {
  background: #e0e0e0;
  color: #111;
  border: 2px solid #888;
  font-weight: 700;
}
.combine-btn {
  min-width: 120px;
  max-width: 220px;
  width: 120px;
  min-height: 64px;
  font-size: 0.85rem;
  white-space: normal;
  padding: 4px 8px;
  line-height: 1.1;
  word-break: break-word;
  text-align: center;
  align-items: center;
  justify-content: center;
  display: flex;
  flex-direction: column;
  user-select: none;
  cursor: pointer;
  flex: none !important;
}
.combine-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 16px;
  width: 100%;
  max-width: 1100px;
  margin: 0 auto;
  padding: 24px 0;
}
/* TF buttons for Liste Technikflaschen: green with black writing */
/* 2x4 grid for main menu buttons */
/* 2 columns x 4 rows for main menu buttons */
.button-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: repeat(4, auto);
  gap: 24px;
  margin: 32px 0;
  justify-items: stretch;
  align-items: stretch;
}
:root{
  --bg:#f4f4f7; --greybtn:#d0d0d6; --purple:#7b4ce6; --black:#111; --white:#fff; --red:#cc2222; --gold:#ffd166; --yellow:#fff18f; --erk:#3b82f6;
}
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto, "Helvetica Neue", Arial;-webkit-user-select:none;user-select:none;-webkit-touch-callout:none;touch-action:manipulation;}
body{background:var(--bg);color:var(--black);display:flex;flex-direction:column;}
header{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;background:#fff;border-bottom:1px solid #e1e1e5;gap:12px;position:fixed;top:0;left:0;right:0;z-index:100;box-shadow:0 2px 8px rgba(0,0,0,0.04)}
.left-controls{display:flex;align-items:center;gap:8px}
.btn{padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:600;display:inline-block;-webkit-tap-highlight-color:transparent}
.btn-black{background:var(--black);color:var(--white)}
.btn-grey{background:var(--greybtn);color:#000}
.btn-purple{background:var(--purple);color:#fff}
.btn-small{padding:6px 10px;font-size:0.9rem;border-radius:6px}
.page-title{margin:8px 0 20px;font-size:1.6rem;text-align:center}
main.container{flex:1;display:block;padding:20px;width:100%;max-width:none;margin:0;padding-top:calc(var(--header-height) + 12px);box-sizing:border-box}

/* Let the document body scroll (not an inner main box). Add top padding so content
   is not hidden under the fixed header. Enable smooth iOS scrolling on the body. */
body {
  /* extra breathing room to ensure the fixed header never covers content;
     increase the extra offset to compensate for any overlapping UI on iPad */
  padding-top: calc(var(--header-height) + 32px);
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
  /* ensure native scrolling places anchors below the fixed header */
  scroll-padding-top: calc(var(--header-height) + 32px);
}

/* Also ensure the document respects scroll padding at the root (helps fragment links) */
html {
  scroll-padding-top: calc(var(--header-height) + 32px);
}
.card{background:#fff;border-radius:12px;box-shadow:0 6px 22px rgba(16,24,40,0.06);padding:18px;max-width:1200px;width:100%}
.center-col{display:flex;flex-direction:column;align-items:center;gap:12px}
.hauptmenu{min-height:60vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:40px 20px;color:#fff}
.main-grid{display:grid;grid-template-columns:repeat(2,1fr);grid-auto-rows:90px;gap:18px;margin-top:18px;max-width:800px;width:100%}
.main-grid .btn{background:var(--greybtn);border-radius:12px;font-size:1.02rem;color:#000}

/* lists & pa buttons */
.page-buttons{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
.fl-btn.gold{background:var(--gold);border:2px solid #000;}
.page-buttons .btn{min-width:180px;padding:12px;border-radius:10px}
.list-item{display:flex;align-items:center;justify-content:space-between;padding:8px 10px;border-radius:8px;border:1px solid #eee;margin-bottom:8px}
.meta-muted{font-size:0.85rem;color:#777}
.pa-btn{display:inline-block;padding:8px 10px;border-radius:8px;margin:4px;border:2px solid #000;cursor:grab;background:var(--gold);min-width:64px;text-align:center;font-weight:700;user-select:none}
.fl-btn{display:inline-block;padding:8px 10px;border-radius:8px;margin:4px;min-width:64px;text-align:center;font-weight:700;user-select:none}
.pa-btn.yellow{background:var(--yellow);border-color:gold}
.erk-btn{display:inline-block;padding:8px 10px;border-radius:8px;margin:4px;border:2px solid #000;cursor:grab;background:var(--erk);color:#fff;min-width:64px;text-align:center;font-weight:700}
.dropzone{min-width:220px;min-height:140px;border:2px dashed #666;border-radius:8px;padding:8px;background:#fafafa;display:flex;flex-direction:column;gap:6px;align-items:flex-start}
.grid-3x3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.area{min-height:120px;border:1px solid #ccc;border-radius:8px;padding:8px;background:#fff;display:flex;flex-direction:column;gap:6px;align-items:flex-start}
.combined-btn{padding:8px 12px;border-radius:10px;font-weight:700;border:2px solid #000;cursor:grab;display:inline-block;min-width:80px;text-align:center}
.small-footer{margin-top:18px;text-align:center;color:#666;font-size:0.9rem}
.search-input{padding:8px 12px;border-radius:10px;border:1px solid #ccc;min-width:220px}
.einsatz-form input.search-input{
  color:#000 !important;
  background:#fff !important;
  caret-color:#000;
}
/* Ensure header search input is readable */
header input.search-input{
  color:#000 !important;
  background:#fff !important;
  caret-color:#000;
}
.btn-einsatz-square {
  width: 100%;
  height: 80px;
  background: var(--red);
  color: var(--white);
  border: none;
  font-weight: bold;
  font-size: 2rem;
  border-radius: 12px;
  margin: 12px 0;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  transition: box-shadow 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}
.psa-dropzone#einsatz-dropzone {
  position: fixed;
  top: 140px;
  /* Respect iOS safe area inset on the right (notch/home indicator) */
  right: env(safe-area-inset-right, 0);
  width: calc(var(--psa-width) + env(safe-area-inset-right, 0));
  height: calc(100vh - 140px);
  min-height: 400px;
  background: #ffeaea;
  border: 2px dashed var(--red);
  border-radius: 0 0 0 24px;
  box-shadow: -2px 0 8px rgba(0,0,0,0.04);
  font-size: 1.2rem;
  margin-left: 0;
  margin-top: 0;
  padding: 0 12px 12px 12px;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  overflow-y: auto;
  z-index: 99999;
}
.psa-container {
  /* Leave space for the PSA dropzone plus a small gap; include safe-area inset */
  margin-right: calc(var(--psa-width) + 20px + env(safe-area-inset-right, 0));
}
@media (max-width:900px){.main-grid{grid-template-columns:repeat(2,1fr)}.page-buttons .btn{min-width:140px;padding:10px}.search-input{min-width:160px}}

/* iPad / small-screen adjustments to avoid horizontal scroll */
@media (max-width:1100px) {
  /* Make main area stack and prevent wide side panels */
  #areas-container { grid-template-columns: 1fr !important; }
  .psa-dropzone#einsatz-dropzone {
    position: static !important;
    width: 100% !important;
    height: auto !important;
    min-height: unset !important;
    border-radius: 12px !important;
    box-shadow: none !important;
    margin: 12px 0 !important;
    padding: 12px !important;
  }
  .psa-container { margin-right: 0 !important; }
  .card { padding: 14px; }
  /* Avoid accidental horizontal scrolling from fixed/floating elements */
  /* Use touch-friendly vertical scrolling and prevent horizontal overflow caused by inner elements */
  html, body { overflow-x: hidden; }
  main.container { overflow-y: auto; -webkit-overflow-scrolling: touch; }
  /* Constrain areas container width to viewport (respect safe-area insets) */
  #areas-container { max-width: calc(100vw - 32px - env(safe-area-inset-left, 0) - env(safe-area-inset-right, 0)); box-sizing: border-box; padding: 0 8px; }
  .card { max-width: calc(100vw - 32px); box-sizing: border-box; }
  /* Make individual moveable areas size-friendly on narrow screens */
  .moveable-area { min-width: auto; width: 100%; }
}

/* Aggressive iPad / narrow-tablet adjustments: hide the fixed right PSA panel
   and tighten min-widths so buttons wrap instead of forcing horizontal overflow. */
@media (max-width:1024px) {
  .psa-dropzone#einsatz-dropzone { display: none !important; }
  .psa-container { margin-right: 0 !important; }
  main.container { padding-left: 10px; padding-right: 10px; }
  /* Make page buttons wrap more tightly */
  .page-buttons .btn, .page-buttons .btn-small, .sidebar-assignment-btn, .combine-btn {
    min-width: 96px !important;
    max-width: 48% !important;
    box-sizing: border-box;
  }
  .sidebar-assignment-grid { gap: 8px; }
  /* Tighter spacing for areas */
  #areas-container { gap: 12px; padding: 0 6px; }
  .moveable-area { padding: 8px; }
  .area-content { gap: 6px; }
  .card { padding: 10px; }
  /* Constrain area content height so the page can scroll vertically */
  .moveable-area { max-height: calc(100vh - 180px); overflow-y: auto; }
}

/* Simulated in-page fullscreen mode (used on iOS where native fullscreen + keyboard is problematic)
   Keep the header visible but compact and fixed so search/navigation remain accessible. */
.app-full header {
  display: flex !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  z-index: 120 !important;
  background: var(--white) !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06) !important;
  padding: 6px 10px !important;
}
.app-full body, .app-full html { height: 100%; }
.app-full main.container {
  padding: 56px 12px 12px 12px; /* reserve header height */
  /* Use the JS-updated --vh custom property to account for iOS dynamic toolbars */
  height: calc((var(--vh, 1vh) * 100) - 56px);
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}
.app-full .card {
  border-radius: 8px;
  box-shadow: none;
  height: auto;
  max-width: 100%;
}
